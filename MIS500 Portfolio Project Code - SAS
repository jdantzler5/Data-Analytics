OPTIONS LS=132 PS=79 NODATE FORMCHAR="|----|+|---+=|-/\<>*" PAGENO=1;
FILENAME MYLOG "/folders/myfolders/data/PP_log.TXT";
FILENAME MYPRINT "/folders/myfolders/data/PP_OUTPUT.TXT";
PROC PRINTTO LOG=MYLOG PRINT=MYPRINT NEW;
RUN;

LIBNAME MYDATA '/folders/myfolders/data';


TITLE1 'MIS500 - PORTFOLIO PROJECT';
TITLE2 'CALCULATE ESTIMATES ON USE AND EXPENDITURES FOR PERSONS WITH SPECIFIC CONDITIONS';



DATA DIAB;
 SET MYDATA.h180;
    IF CCCODEX IN ('049', '050');
RUN;

DATA COPD;
 SET MYDATA.h180;
 	IF CCCODEX IN ('127', '128', '129', '130', '131', '132', '133', '134');
RUN;

DATA STK;
 SET MYDATA.h180;
 	IF CCCODEX >= 109 AND CCCODEX <= 113;
RUN;

DATA CANC;
 SET MYDATA.h180;
 	IF CCCODEX >= 11 AND CCCODEX <= 45;
RUN;

DATA HEART;
 SET MYDATA.h180;
 	IF CCCODEX IN (097, 098, 100, 101, 102, 103, 104, 105, 106, 107, 108);
RUN;

PROC SORT DATA=DIAB OUT=DIABPERS (KEEP=DUPERSID) NODUPKEY;
  BY DUPERSID;
RUN;

PROC SORT DATA=COPD OUT=COPDPERS (KEEP=DUPERSID) NODUPKEY;
  BY DUPERSID;
RUN;

PROC SORT DATA=STK OUT=STKPERS (KEEP=DUPERSID) NODUPKEY;
  BY DUPERSID;
RUN;

PROC SORT DATA=CANC OUT=CANCPERS (KEEP=DUPERSID) NODUPKEY;
  BY DUPERSID;
RUN;

PROC SORT DATA=HEART OUT=HEARTPERS (KEEP=DUPERSID) NODUPKEY;
  BY DUPERSID;
RUN;

DATA  FY1;
MERGE MYDATA.h181 (IN=AA)
      DIABPERS   (IN=BB) 
      COPDPERS	(IN=CC)
      STKPERS	(IN=DD) 
      CANCPERS	(IN=EE)
      HEARTPERS (IN=FF);
   BY DUPERSID;

      LABEL DIABPERS='PERSONS WHO REPORTED DIABETES';
      IF AA AND BB THEN DIABPERS = 1;
                   ELSE DIABPERS = 2;

      LABEL COPDPERS='PERSONS WHO REPORTED COPD';
      IF AA AND CC THEN COPDPERS = 1;
                   ELSE COPDPERS = 2;
                   
      LABEL COPDPERS='PERSONS WHO REPORTED STROKE';
      IF AA AND DD THEN STKPERS = 1;
                   ELSE STKPERS = 2;
                   
      LABEL COPDPERS='PERSONS WHO REPORTED CANCER';
      IF AA AND EE THEN CANCPERS = 1;
                   ELSE CANCPERS = 2;
      
      LABEL COPDPERS='PERSONS WHO REPORTED HEART DISEASE';
      IF AA AND FF THEN HEARTPERS = 1;
                   ELSE HEARTPERS = 2;
RUN;


ODS GRAPHICS OFF;
ODS LISTING CLOSE;



PROC SURVEYMEANS DATA=FY1 NOBS SUMWGT SUM STD MEAN STDERR;
	DOMAIN DIABPERS('1') COPDPERS('1') STKPERS('1') CANCPERS('1') HEARTPERS('1');
	VAR TOTEXP15 TOTSLF15 OBTOTV15;
      ods output domain=work.domain_results;
RUN;

ODS LISTING;


PROC PRINTTO;
RUN;
